# WireGuard Universal CLI v4.0

Профессиональный CLI инструмент для управления WireGuard VPN серверами. Минималистичный интерфейс, максимальная функциональность. Современные subcommands, конфигурационная система, расширенная диагностика.

## Главная особенность

**Современный CLI интерфейс** с интуитивными командами, цветным выводом, прогресс-барами и автоматической диагностикой. Один инструмент для всех задач по управлению VPN.

## Возможности

- **Современный CLI** - интуитивные subcommands, цветной вывод, прогресс-бары
- **Универсальные оптимизации** - работает идеально на WiFi, мобильном интернете, любых сетях
- **Проверенные настройки** - MTU 1342, PersistentKeepalive 21, оптимальные TCP параметры
- **Управление клиентами** - добавление, удаление, просмотр конфигураций
- **Расширенная диагностика** - автоматическое обнаружение и исправление проблем
- **Конфигурационная система** - гибкая настройка через конфиг-файлы
- **Мониторинг в реальном времени** - отслеживание подключений и трафика

## Структура проекта

```
wg.sh/
├── wg-cli.sh              # [MAIN] ГЛАВНЫЙ CLI - профессиональное управление VPN!
├── QUICK-START.md         # [QUICK] Краткая инструкция (памятка)
├── README.md              # [DOCS] Полная документация (этот файл)
├── FEATURE.md             # [ROADMAP] План развития и технические детали
├── CLAUDE.md              # [AI] Инструкции для ИИ-ассистента
└── LICENSE                # [LICENSE] Лицензия GPL v3
```

**Минималистичная структура. CLI-first подход.**

## [MAIN] CLI Интерфейс

### `wg-cli.sh` - Профессиональный CLI инструмент

Современный командный интерфейс для полного управления WireGuard VPN серверами. Все операции через интуитивные subcommands с цветным выводом и автоматической диагностикой.

**Что делает автоматически:**
- [OK] Устанавливает WireGuard (если не установлен)
- [OK] Определяет оптимальные сетевые интерфейсы
- [OK] Выбирает свободный порт (51820 или 443)
- [OK] Генерирует криптографические ключи
- [OK] Настраивает IP forwarding и TCP оптимизации
- [OK] Конфигурирует правила firewall и MASQUERADE
- [OK] Создает серверную конфигурацию с оптимальными параметрами
- [OK] Генерирует готовые клиентские конфигурации
- [OK] Запускает и тестирует VPN сервер
- [OK] Включает автозапуск сервиса

**Использованные проверенные значения:**
- **MTU: 1342** - оптимальный для всех сетей
- **PersistentKeepalive: 21** секунда - предотвращает разрывы
- **DNS: 1.1.1.1** - быстрый и надежный
- **TCP оптимизации** - для максимальной производительности

## [QUICK] Сверхбыстрый старт

### CLI команды - профессиональное управление VPN!

```bash
# 1. Скачайте CLI
curl -O https://raw.githubusercontent.com/your-repo/wg.sh/main/wg-cli.sh

# 2. Сделайте исполняемым
chmod +x wg-cli.sh

# 3. Установите VPN сервер
sudo ./wg-cli.sh setup

# 4. Проверьте статус
./wg-cli.sh status

# 5. Мониторинг подключений
sudo ./wg-cli.sh monitor
```

**Современный CLI с интуитивными командами!**

## [COMMANDS] Основные команды

### Установка и настройка
```bash
sudo ./wg-cli.sh setup          # Установить и настроить VPN сервер
```

### Управление и мониторинг
```bash
./wg-cli.sh status              # Показать статус сервера
sudo ./wg-cli.sh monitor        # Мониторинг в реальном времени
sudo ./wg-cli.sh diagnose       # Комплексная диагностика
sudo ./wg-cli.sh diagnose --fix # Диагностика с автоисправлением
```

### Управление клиентами
```bash
./wg-cli.sh clients list        # Список клиентских конфигураций
./wg-cli.sh clients add john    # Добавить клиента 'john'
./wg-cli.sh clients remove john # Удалить клиента 'john'
```

### Конфигурация
```bash
./wg-cli.sh config show         # Показать текущую конфигурацию
./wg-cli.sh config edit         # Редактировать конфигурацию
```

### Информация
```bash
./wg-cli.sh version             # Показать версию
./wg-cli.sh help                # Показать справку
```

### Глобальные опции
```bash
./wg-cli.sh -v status           # Подробный вывод (verbose)
./wg-cli.sh -q setup            # Тихий режим (quiet)
./wg-cli.sh -c /path/to/config  # Использовать другой конфиг
```

### Что получите в результате:

- **Профессиональный CLI** - современный интерфейс для всех операций  
- **Готовый VPN сервер** - работает сразу после setup  
- **Умная диагностика** - автоматическое обнаружение проблем  
- **Гибкое управление** - полный контроль через команды

## Диагностика и решение проблем

### Автоматическая диагностика

```bash
# Комплексная проверка системы
sudo ./wg-cli.sh diagnose

# Диагностика с автоисправлением
sudo ./wg-cli.sh diagnose --fix

# Мониторинг в реальном времени  
sudo ./wg-cli.sh monitor
```

### Основные проблемы

**Если интернет через VPN не работает:**

1. **Облачный firewall (частая причина)**
   ```bash
   # Откройте порт в панели управления VPS:
   # AWS: Security Groups, DigitalOcean: Firewall Rules
   # Vultr: Firewall, Hetzner: Firewall Rules
   
   # Проверка доступности порта
   nmap -p 443 -sU ВАШ_IP_СЕРВЕРА
   ```

2. **Конфликт с Docker**
   ```bash
   sudo systemctl stop docker
   sudo ./wg-cli.sh diagnose --fix
   ```

3. **Проблемы с NAT**
   ```bash
   sudo iptables -t nat -F POSTROUTING
   sudo systemctl restart wg-quick@wg0
   ```

### Сбор диагностической информации

```bash
# Создание отчета для техподдержки
sudo ./wg-cli.sh diagnose > debug-report.txt 2>&1
```

## Настройка клиентов

### Управление клиентами через CLI

```bash
# Просмотр клиентов
./wg-cli.sh clients list

# Добавление клиента
./wg-cli.sh clients add имя_клиента

# Удаление клиента
./wg-cli.sh clients remove имя_клиента
```

### Подключение устройств

1. **Мобильные устройства:** Установите приложение WireGuard и импортируйте файл конфигурации
2. **Компьютеры:** Установите WireGuard с официального сайта и импортируйте конфигурацию

Конфигурации создаются в `/etc/wireguard/clients/` с правильным IP сервера.

## Управление

### Основные операции

```bash
# Статус сервера
./wg-cli.sh status

# Мониторинг в реальном времени
sudo ./wg-cli.sh monitor

# Просмотр конфигурации
./wg-cli.sh config show

# Редактирование настроек
./wg-cli.sh config edit
```

### Важные файлы

- **Конфигурация сервера:** `/etc/wireguard/wg0.conf`
- **Клиентские конфигурации:** `/etc/wireguard/clients/`  
- **CLI конфигурация:** `/etc/wg-cli/config.conf`
- **Логи:** `/var/log/wg-cli.log`

## Особенности

- **Проверенные настройки** - протестированы в продакшне
- **Полная автоматизация** - от установки до готового сервера  
- **Универсальность** - работает на всех устройствах и сетях
- **Умная диагностика** - автоматическое обнаружение проблем

## Лицензия

GPL v3 - см. файл LICENSE

## Автор

Senior Shell Developer - Эксперт по UNIX системам и сетевым технологиям